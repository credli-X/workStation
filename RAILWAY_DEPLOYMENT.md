# Railway Deployment Guide - Workstation AI Agent

## Overview
This guide provides complete instructions for deploying the Workstation AI Agent to Railway.app.

## What This App Includes

### ü§ñ **15+ Automation Agents**
Located in `src/automation/agents/`:
- **Browser Agent** - Playwright-based web automation
- **Email Agent** - Gmail, IMAP, SMTP integration
- **Calendar Agent** - Google Calendar automation
- **Sheets Agent** - Google Sheets integration
- **File Agent** - Local and cloud file operations
- **Database Agent** - PostgreSQL and SQLite support
- **S3 Agent** - AWS S3 and S3-compatible storage
- **CSV Agent** - CSV parsing and transformation
- **JSON Agent** - JSON operations and querying
- **Excel Agent** - Excel file manipulation
- **PDF Agent** - PDF text extraction and generation
- **RSS Agent** - RSS feed parsing and monitoring
- **Enrichment Agent** - Data enrichment with external APIs

### üé® **Visual UI Dashboards**
Located in `public/`:
- **Main Dashboard** (`dashboard.html`) - Workflow monitoring and management
- **Workflow Builder** (`workflow-builder.html`) - Drag-and-drop automation designer
- **Gemini Dashboard** (`gemini-dashboard.html`) - AI-powered insights
- **Setup Wizard** (`setup.html`) - Initial configuration

### üåê **Chrome Extensions**
Pre-built in `dist/`:
- `workstation-ai-agent-v2.1.0.zip` (97KB) - Standard version
- `workstation-ai-agent-enterprise-v2.1.0.zip` (143KB) - Enterprise version

### üîß **Workflow Management**
- Workflow execution engine
- State management and persistence
- Template system with pre-built workflows
- Parallel execution orchestration
- Dependency management

## Prerequisites

### Required
- Railway.app account (free tier available)
- Node.js 18+ (Railway handles this automatically)
- Git repository access

### Optional (for full functionality)
- PostgreSQL database (Railway provides free tier)
- Google Cloud credentials (for Sheets/Calendar/Gmail)
- AWS credentials (for S3 storage)
- Slack workspace (for notifications)

## Quick Deploy to Railway

### Option 1: Deploy from GitHub (Recommended)

1. **Fork or Clone Repository**
   ```bash
   git clone https://github.com/credli-X/workstation.git
   cd workstation
   ```

2. **Push to Your GitHub Repository**
   ```bash
   git remote add origin YOUR_GITHUB_REPO_URL
   git push -u origin main
   ```

3. **Connect to Railway**
   - Go to [railway.app](https://railway.app)
   - Click "New Project"
   - Select "Deploy from GitHub repo"
   - Choose your forked repository
   - Railway will auto-detect the configuration from `railway.json`

4. **Configure Environment Variables**
   Railway will automatically generate `JWT_SECRET`. Add these if needed:
   ```
   JWT_SECRET=auto-generated-by-railway
   JWT_EXPIRATION=24h
   NODE_ENV=production
   PORT=3000
   ```

5. **Deploy**
   - Railway builds automatically using: `npm install && npm run build`
   - Starts with: `npm start`
   - Your app will be live at: `https://your-app.railway.app`

### Option 2: Deploy with Railway CLI

1. **Install Railway CLI**
   ```bash
   npm install -g @railway/cli
   ```

2. **Login and Initialize**
   ```bash
   railway login
   railway init
   ```

3. **Deploy**
   ```bash
   railway up
   ```

4. **Set Environment Variables**
   ```bash
   railway variables set JWT_SECRET=$(node -e "console.log(require('crypto').randomBytes(32).toString('hex'))")
   railway variables set JWT_EXPIRATION=24h
   ```

5. **Open Your App**
   ```bash
   railway open
   ```

## Configuration

### Essential Environment Variables

```env
# Authentication (Required)
JWT_SECRET=<auto-generated-or-custom-secret>
JWT_EXPIRATION=24h

# Server Configuration
PORT=3000
NODE_ENV=production

# Database (Optional - for workflow persistence)
DATABASE_URL=postgresql://user:password@host:port/database

# Google Workspace Integration (Optional)
GOOGLE_CLIENT_ID=your-client-id
GOOGLE_CLIENT_SECRET=your-client-secret
GOOGLE_REDIRECT_URI=https://your-app.railway.app/auth/google/callback

# AWS S3 (Optional)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_S3_BUCKET=your-bucket-name

# Slack Integration (Optional)
SLACK_BOT_TOKEN=xoxb-your-token
SLACK_SIGNING_SECRET=your-signing-secret

# Monitoring (Optional)
SENTRY_DSN=your-sentry-dsn
```

### Railway-Specific Configuration

The `railway.json` file is pre-configured:
```json
{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS",
    "buildCommand": "npm install && npm run build"
  },
  "deploy": {
    "startCommand": "npm start",
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  }
}
```

## Post-Deployment

### 1. Verify Deployment

Check health endpoint:
```bash
curl https://your-app.railway.app/health
```

Expected response:
```json
{
  "status": "healthy",
  "uptime": 123.45,
  "timestamp": "2024-12-13T23:00:00.000Z"
}
```

### 2. Access UI Dashboards

- **Main Dashboard**: `https://your-app.railway.app/legacy/dashboard.html`
- **Workflow Builder**: `https://your-app.railway.app/legacy/workflow-builder.html`
- **Gemini Dashboard**: `https://your-app.railway.app/legacy/gemini-dashboard.html`
- **Setup Wizard**: `https://your-app.railway.app/legacy/setup.html`

### 3. Generate Authentication Token

```bash
curl -X POST https://your-app.railway.app/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "your-password"}'
```

### 4. Test Automation Agent

```bash
curl -X POST https://your-app.railway.app/api/automation/execute \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "agentType": "browser",
    "action": "navigate",
    "params": {
      "url": "https://example.com"
    }
  }'
```

## Database Setup (Optional)

### Add PostgreSQL to Railway

1. **In Railway Dashboard**
   - Click "New" ‚Üí "Database" ‚Üí "PostgreSQL"
   - Railway provisions a database and adds `DATABASE_URL` automatically

2. **Initialize Database Schema**
   ```bash
   # Connect to Railway PostgreSQL
   railway run psql $DATABASE_URL -f src/automation/db/schema.sql
   ```

3. **Verify Tables Created**
   ```bash
   railway run psql $DATABASE_URL -c "\dt"
   ```

## Scaling and Performance

### Railway Free Tier
- ‚úÖ 500 hours/month execution time
- ‚úÖ 512MB RAM
- ‚úÖ 1GB disk space
- ‚úÖ Automatic HTTPS
- ‚úÖ Custom domains

### Upgrade Recommendations
For production workloads:
- **Developer Plan** ($5/month): 500 hours, shared resources
- **Team Plan** ($20/month): More resources, team collaboration
- **Monitor usage**: Railway dashboard shows real-time metrics

## Monitoring and Logs

### View Logs
```bash
# Via CLI
railway logs

# Via Dashboard
railway open
# Click "Logs" tab
```

### Health Monitoring
Set up external monitoring:
- **UptimeRobot**: Free 50 monitors
- **Better Uptime**: Free tier available
- Monitor: `https://your-app.railway.app/health`

### Metrics Endpoint
Available at: `https://your-app.railway.app/metrics`
- Prometheus-compatible metrics
- Request rates, latencies, errors
- System resource usage

## Troubleshooting

### Build Fails

1. **Check Railway Logs**
   ```bash
   railway logs --deployment
   ```

2. **Common Issues**
   - Missing dependencies: Check `package.json`
   - TypeScript errors: Run `npm run build` locally first
   - Environment variables: Verify in Railway dashboard

### App Crashes on Start

1. **JWT_SECRET Missing**
   ```bash
   railway variables set JWT_SECRET=$(node -e "console.log(require('crypto').randomBytes(32).toString('hex'))")
   ```

2. **Port Configuration**
   Railway provides `PORT` env variable automatically. App listens on this port.

3. **Database Connection**
   If using PostgreSQL, ensure `DATABASE_URL` is set and database is initialized.

### UI Not Loading

1. **Check Static File Routes**
   - Legacy UI: `/legacy/dashboard.html`
   - Modern UI: `/dashboard` (if built with Vite)

2. **Build Assets**
   ```bash
   npm run build:all  # Builds both backend and frontend
   ```

## Advanced Configuration

### Custom Domain

1. **In Railway Dashboard**
   - Go to Settings ‚Üí Domains
   - Click "Add Domain"
   - Enter your domain (e.g., `automation.yourcompany.com`)

2. **Update DNS**
   - Add CNAME record pointing to Railway's provided domain
   - SSL is handled automatically by Railway

### Multiple Environments

Create separate Railway projects:
- **Production**: `workstation-prod`
- **Staging**: `workstation-staging`
- **Development**: Local development only

### CI/CD Integration

Railway auto-deploys on git push. To customize:

```yaml
# .github/workflows/deploy.yml
name: Deploy to Railway
on:
  push:
    branches: [main]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Deploy to Railway
        run: |
          npm install -g @railway/cli
          railway up --service ${{ secrets.RAILWAY_SERVICE_ID }}
        env:
          RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
```

## Chrome Extension Distribution

### Download Extensions
Extensions are available at:
- Standard: `https://your-app.railway.app/api/downloads/chrome-extension`
- Enterprise: `https://your-app.railway.app/api/downloads/chrome-extension-enterprise`

### Install Extension
1. Download ZIP file
2. Go to `chrome://extensions`
3. Enable "Developer mode"
4. Click "Load unpacked"
5. Select extracted extension folder

## Security Best Practices

### 1. Environment Variables
‚úÖ Never commit secrets to git
‚úÖ Use Railway's environment variables
‚úÖ Rotate JWT_SECRET periodically

### 2. Database Security
‚úÖ Use Railway's managed PostgreSQL (encrypted at rest)
‚úÖ Restrict database access to Railway network
‚úÖ Regular backups enabled by default

### 3. API Security
‚úÖ Rate limiting enabled (100 req/15min)
‚úÖ Helmet.js security headers
‚úÖ CORS configured
‚úÖ JWT token authentication

### 4. Monitoring
‚úÖ Set up error tracking (Sentry integration available)
‚úÖ Monitor `/health` endpoint
‚úÖ Review Railway logs regularly

## Support and Resources

### Documentation
- **API Reference**: See `/docs/API.md` in repository
- **Architecture**: See `/docs/ARCHITECTURE.md`
- **Workflow Templates**: See `/docs/WORKFLOW_TEMPLATES.md`

### Community
- **GitHub Issues**: https://github.com/credli-X/workstation/issues
- **Railway Discord**: https://discord.gg/railway
- **Railway Docs**: https://docs.railway.app

### Getting Help
1. Check Railway logs: `railway logs`
2. Review health endpoint: `/health`
3. Test locally first: `npm run dev`
4. Open GitHub issue with logs and error messages

## Quick Start Checklist

- [ ] Repository cloned/forked
- [ ] Railway account created
- [ ] Project deployed to Railway
- [ ] JWT_SECRET configured (auto-generated by Railway)
- [ ] Health check passed (`/health` returns 200)
- [ ] UI dashboards accessible
- [ ] Authentication token generated
- [ ] Test automation agent executed
- [ ] (Optional) PostgreSQL database added
- [ ] (Optional) Google/AWS credentials configured
- [ ] (Optional) Custom domain configured
- [ ] Monitoring set up

## Next Steps

After successful deployment:

1. **Explore UI Dashboards**
   - Create your first workflow in Workflow Builder
   - Monitor executions in Main Dashboard
   - Try Gemini AI insights

2. **Create Custom Workflows**
   - Use API to create workflows programmatically
   - Import templates from `/docs/WORKFLOW_TEMPLATES.md`
   - Build automations with drag-and-drop builder

3. **Integrate with Your Tools**
   - Connect Google Workspace (Sheets, Calendar, Gmail)
   - Set up AWS S3 for file storage
   - Configure Slack notifications

4. **Scale Your Automation**
   - Deploy multiple workflow instances
   - Set up scheduled executions
   - Monitor performance with `/metrics`

## Conclusion

Your Workstation AI Agent is now deployed to Railway! üöÄ

- **Live App**: `https://your-app.railway.app`
- **Health Check**: `https://your-app.railway.app/health`
- **Dashboard**: `https://your-app.railway.app/legacy/dashboard.html`
- **API Docs**: Available at `/docs/API.md`

For questions or issues, please open a GitHub issue or consult Railway's documentation.

**Happy Automating!** ü§ñ‚ú®
